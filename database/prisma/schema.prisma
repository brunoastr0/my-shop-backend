generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model clients {
  id           String   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id    String?  @db.Uuid
  fullname     String   @db.VarChar(255)
  email        String   @unique @db.VarChar(255)
  phone_number String?  @db.VarChar(15)
  address      String?
  created_at   DateTime @default(now()) @db.Timestamptz(6)
  tenants      tenants? @relation(fields: [tenant_id], references: [id], onUpdate: NoAction)
  orders       orders[]
}

model order_items {
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  order_id   String?   @db.Uuid
  product_id String?   @db.Uuid
  quantity   Int       @default(1)
  price      Decimal   @db.Decimal
  orders     orders?   @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products   products? @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model orders {
  id           String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  client_id    String?       @db.Uuid
  tenant_id    String?       @db.Uuid
  order_date   DateTime      @default(now()) @db.Timestamptz(6)
  total_amount Decimal       @default(0) @db.Decimal
  status       String        @db.VarChar(64)
  order_items  order_items[]
  clients      clients?      @relation(fields: [client_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenants      tenants?      @relation(fields: [tenant_id], references: [id], onUpdate: NoAction)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model products {
  id                  String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id           String?       @db.Uuid
  product_name        String        @db.VarChar(255)
  sale_price          Decimal?      @default(0) @db.Decimal
  quantity            Int?          @default(0)
  product_description String
  published           Boolean?      @default(true)
  created_at          DateTime      @default(now()) @db.Timestamptz(6)
  order_items         order_items[]
  tenants             tenants?      @relation(fields: [tenant_id], references: [id], onUpdate: NoAction)

  @@index([tenant_id, id, published], map: "idx_tenant_id_published")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model tenants {
  id         String     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  store_name String     @unique @db.VarChar(63)
  fullname   String     @db.VarChar(255)
  email      String     @unique @db.VarChar(255)
  status     String     @db.VarChar(64)
  created_at DateTime   @default(now()) @db.Timestamptz(6)
  clients    clients[]
  orders     orders[]
  products   products[]
}
